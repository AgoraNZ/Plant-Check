<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dairy Shed Hygiene Checklist</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <style>
        body {
            background-color: #002B5C;
            color: #FFFFFF;
            font-family: Arial, sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            margin: 0;
        }
        .container {
            background-color: #002B5C;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            max-width: 800px;
            width: 100%;
        }
        h1, h2 {
            color: #FF851B;
            text-align: center;
        }
        label {
            margin-top: 10px;
        }
        button {
            background-color: #FF851B;
            color: #FFFFFF;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            display: block;
            margin: 20px auto;
            border-radius: 5px;
        }
        button:hover {
            background-color: #FF4136;
        }
        .checklist-item {
            margin-bottom: 30px;
        }
        .form-control, .form-select {
            margin-top: 5px;
        }
        .version {
            text-align: center;
            margin-top: 20px;
            color: #FFFFFF;
            font-size: 12px;
        }
        #logo-container {
            text-align: center;
            margin-bottom: 20px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <div class="container">
        <div id="logo-container">
            <img src="https://via.placeholder.com/150" id="logo-image" alt="Company Logo">
        </div>
        <h1>Dairy Shed Hygiene Checklist</h1>
        
        <form id="hygiene-checklist-form">
            <!-- Farm Details Section -->
            <div class="section mb-4">
                <h2>Farm Details</h2>
                <label for="dairy-company">Dairy Company:</label>
                <select id="dairy-company" name="dairy-company" class="form-select">
                    <option value="fonterra">Fonterra</option>
                    <option value="dairy-goat-coop">Dairy Goat Co-op</option>
                    <option value="green-valley">Green Valley Dairies</option>
                    <option value="maui-milk">Maui Milk</option>
                    <option value="oceania">Oceania</option>
                    <option value="ofi">OFI</option>
                    <option value="synlait">Synlait Milk LTD</option>
                    <option value="tatua">Tatua</option>
                </select>
                <label for="dairy-number">Dairy Number:</label>
                <input type="text" class="form-control" id="dairy-number" name="dairy-number">
                <label for="address">Address:</label>
                <input type="text" class="form-control" id="address" name="address">
                <label for="customer-name">Customer Name:</label>
                <input type="text" class="form-control" id="customer-name" name="customer-name">
                <label for="region">Region:</label>
                <select id="region" name="region" class="form-select">
                    <option value="northland">Northland</option>
                    <option value="auckland">Auckland</option>
                    <option value="waikato">Waikato</option>
                    <option value="bay-of-plenty">Bay of Plenty</option>
                    <option value="gisborne">Gisborne</option>
                    <option value="hawkes-bay">Hawke's Bay</option>
                    <option value="taranaki">Taranaki</option>
                    <option value="manawatu-wanganui">Manawatu-Wanganui</option>
                    <option value="wellington">Wellington</option>
                    <option value="nelson">Nelson</option>
                    <option value="marlborough">Marlborough</option>
                    <option value="west-coast">West Coast</option>
                    <option value="canterbury">Canterbury</option>
                    <option value="otago">Otago</option>
                    <option value="southland">Southland</option>
                </select>
                <label for="farm-name">Farm Name:</label>
                <input type="text" class="form-control" id="farm-name" name="farm-name">
                <label for="island">Island:</label>
                <select id="island" name="island" class="form-select">
                    <option value="north-island">North Island</option>
                    <option value="south-island">South Island</option>
                </select>
                <label for="visit-date">Visit Date:</label>
                <input type="date" class="form-control" id="visit-date" name="visit-date">
                <label for="visit-type">Visit Type:</label>
                <input type="text" class="form-control" id="visit-type" name="visit-type" value="Milking Plant & Milk Vat Check" readonly>
                <label for="inspection-start-time">Inspection Start Time:</label>
                <input type="time" class="form-control" id="inspection-start-time" name="inspection-start-time">
                <label for="inspection-end-time">Inspection End Time:</label>
                <input type="time" class="form-control" id="inspection-end-time" name="inspection-end-time">
                <label for="inspection-completed-by">Inspection Completed By:</label>
                <input type="text" class="form-control" id="inspection-completed-by" name="inspection-completed-by">
                <label for="call-type">Call Type:</label>
                <select id="call-type" name="call-type" class="form-select">
                    <option value="alert">Alert</option>
                    <option value="grade-call">Grade Call</option>
                    <option value="regular-scheduled-visit" selected>Regular Scheduled Visit</option>
                </select>
            </div>

            <button type="button" onclick="generatePDF()">Generate PDF</button>
        </form>
        <div class="version">Version 5.5</div>
    </div>

    <script>
        const { jsPDF } = window.jspdf;
        const checklistItems = [
            "Pulsator Airline", "Long Bend Elbows", "Automatic Cup and Remover", "Diaphragm", "Receiving Can",
            "Sanitary Trap", "Main Milk Line", "Milk Line Seals in Good Condition", "Stainless Droppers", "Long Milk Rubber",
            "Liner", "Cluster", "Cluster Seal", "Cluster Button", "Non Return Valve at Milk Pump", "Milk Pump",
            "Filter Housing", "Plate Cooler", "Interceptor", "Receiver Airline", "Flushing Pulsator", "Air Purge Valve",
            "Vacuum Level", "Main Airline", "Plant Drainage - Milk Pump", "Plant Drainage - Filter/s", "Plant Drainage - Plate Cooler",
            "Plant Drainage - Vat Entry", "Plant Wash Tap", "Wash Jetters", "Centre Gland", "Test Bucket", "Inlet Valve",
            "Non-Return Valve", "Spray Ball", "Agitator", "Silo Door", "Manhole Seal", "Vat Outlet", "Walls in Silo"
        ];

        document.addEventListener("DOMContentLoaded", () => {
            createChecklistItems();
        });

        function createChecklistItems() {
            const checklistContainer = document.getElementById('checklist-items');
            checklistContainer.innerHTML = '';

            checklistItems.forEach(item => {
                const itemContainer = document.createElement('div');
                itemContainer.classList.add('checklist-item');

                const label = document.createElement('label');
                label.textContent = item;
                itemContainer.appendChild(label);

                const statusSelect = document.createElement('select');
                statusSelect.classList.add('form-select');
                statusSelect.innerHTML = `
                    <option value="ok">OK</option>
                    <option value="attention-required">Attention Required</option>
                    <option value="na">N/A</option>
                    <option value="not-checked">Not Checked</option>
                `;
                itemContainer.appendChild(statusSelect);

                const commentsInput = document.createElement('input');
                commentsInput.type = 'text';
                commentsInput.classList.add('form-control');
                commentsInput.placeholder = 'Comments';
                itemContainer.appendChild(commentsInput);

                checklistContainer.appendChild(itemContainer);
            });
        }

        async function generatePDF() {
            const form = document.getElementById('hygiene-checklist-form');
            let formData = new FormData(form);
            const dairyNumber = formData.get('dairy-number');

            let pdf = new jsPDF('p', 'pt', 'a4');
            pdf.setFontSize(22);
            pdf.setTextColor('#002B5C');

            // Adding logo from the image URL
            try {
                const img = document.getElementById('logo-image');
                const logoWidth = 100;
                const logoHeight = 50;

                const imgUrl = img.src;
                const imageToAdd = new Image();
                imageToAdd.src = imgUrl;

                // Draw the logo once loaded
                imageToAdd.onload = function() {
                    pdf.addImage(imageToAdd, 'JPEG', 40, 30, logoWidth, logoHeight);
                    completePDFCreation();
                };
            } catch (error) {
                console.error("Failed to add the logo:", error);
                completePDFCreation();
            }

            function completePDFCreation() {
                pdf.text('Dairy Shed Hygiene Checklist', 200, 50);

                pdf.setFontSize(12);
                pdf.setTextColor('#000000');
                pdf.setFont('helvetica', 'bold');
                pdf.text('Farm Details:', 40, 150);

                pdf.setFont('helvetica', 'normal');
                pdf.text(`Dairy Company: ${formData.get('dairy-company')}`, 40, 170);
                pdf.text(`Dairy Number: ${formData.get('dairy-number')}`, 40, 185);
                pdf.text(`Address: ${formData.get('address')}`, 40, 200);
                pdf.text(`Customer Name: ${formData.get('customer-name')}`, 40, 215);
                pdf.text(`Region: ${formData.get('region')}`, 40, 230);
                pdf.text(`Farm Name: ${formData.get('farm-name')}`, 40, 245);
                pdf.text(`Island: ${formData.get('island')}`, 40, 260);
                pdf.text(`Visit Date: ${formData.get('visit-date')}`, 40, 275);
                pdf.text(`Visit Type: ${formData.get('visit-type')}`, 40, 290);
                pdf.text(`Inspection Start Time: ${formData.get('inspection-start-time')}`, 40, 305);
                pdf.text(`Inspection End Time: ${formData.get('inspection-end-time')}`, 40, 320);
                pdf.text(`Inspection Completed By: ${formData.get('inspection-completed-by')}`, 40, 335);
                pdf.text(`Call Type: ${formData.get('call-type')}`, 40, 350);

                // Generate checklist items table
                const checklistItemsDiv = document.getElementById('checklist-items').children;
                const checklistTable = [];

                for (let item of checklistItemsDiv) {
                    const itemName = item.querySelector('label').textContent;
                    const status = item.querySelector('select').value;
                    const comments = item.querySelector('input[type="text"]').value;

                    checklistTable.push([itemName, status, comments]);
                }

                pdf.autoTable({
                    startY: 370,
                    head: [['Item', 'Status', 'Comments']],
                    body: checklistTable,
                    styles: {
                        fontSize: 10,
                        cellPadding: 5,
                    },
                    headStyles: {
                        fillColor: '#002B5C',
                        textColor: '#FFFFFF'
                    }
                });

                // Save PDF
                pdf.save('Dairy_Shed_Hygiene_Checklist.pdf');
            }
        }
    </script>
</body>
</html>
